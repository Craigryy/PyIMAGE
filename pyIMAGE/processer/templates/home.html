{% extends 'base.html' %}
{% load socialaccount %}
{% providers_media_js %}

{% block content %}
    <body>
    <p>Login with Facebook:</p>

    <!-- Form for logging in with Facebook -->
    <form method="GET" action="{% provider_login_url 'facebook' method='oauth2' %}">
        <button type="submit">Login with Facebook</button>
    </form>

    <!-- Display Facebook profile picture and name -->
    <div id="facebook-profile" style="display: none;">
        <img id="fb-profile-picture" src="" alt="Facebook Profile Picture">
        <span id="fb-name"></span>
    </div>

    <script>
        // Load Facebook SDK asynchronously
        window.fbAsyncInit = function () {
            FB.init({
                appId: '652632226850429',  // Your Facebook App ID
                cookie: true,
                xfbml: true,
                version: 'v12.0'
            });

            FB.AppEvents.logPageView();

            // Check if the user is logged in with Facebook
            FB.getLoginStatus(function (response) {
                if (response.status === 'connected') {
                    // Logged into your app and Facebook
                    FB.api('/me', { fields: 'name,picture' }, function (response) {
                        if (response && !response.error) {
                            document.getElementById('fb-profile-picture').src = response.picture.data.url;
                            document.getElementById('fb-name').innerText = 'Hello, ' + response.name;
                            document.getElementById('facebook-profile').style.display = 'block';
                        }
                    });
                }
            });
        };

        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement(s); js.id = id;
            js.src = 'https://connect.facebook.net/en_US/sdk.js';
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
    </body>
{% endblock content %}
